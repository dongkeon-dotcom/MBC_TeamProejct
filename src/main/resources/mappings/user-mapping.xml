<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="USER">

    <insert id="INSERT" parameterType="com.mbcTeam.user.UserVO">
        INSERT INTO users (
            id, password, user_Name, user_Phone, user_Role, is_easy_login, is_deleted, reg_Date
        ) VALUES (
            #{id}, #{password}, #{userName}, #{userPhone}, #{userRole}, #{easyLogin}, #{deleted}, NOW()
        )
    </insert>
<select id="LOGIN" parameterType="com.mbcTeam.user.UserVO" resultType="com.mbcTeam.user.UserVO">
    SELECT  
       user_idx       AS userIdx,
        id, 
        password, 
        user_Name      AS userName,    user_Phone     AS userPhone,   user_Role      AS userRole,    is_easy_login  AS easyLogin,   is_deleted     AS deleted,     reg_Date       AS regDate      FROM users 
    WHERE id = #{id} 
      AND password = #{password} 
      AND is_deleted = 0               </select>

    <select id="getById" parameterType="com.mbcTeam.user.UserVO" resultType="com.mbcTeam.user.UserVO">
        SELECT
       user_idx       AS userIdx,
            user_email     AS id,
            user_pw        AS password,
            user_name      AS userName,
            user_phone     AS userPhone,
            user_role      AS userRole,
            easy_login     AS easyLogin,
            deleted        AS deleted,
            user_reg_date  AS regDate
        FROM users
        WHERE userIdx = #{userIdx}
    </select>

    <update id="update" parameterType="com.mbcTeam.user.UserVO">
        UPDATE users
        SET
            user_name  = #{userName},
            user_phone = #{userPhone}
        WHERE userIdx = #{userIdx}
    </update>

    <update id="delete" parameterType="com.mbcTeam.user.UserVO">
        UPDATE users
        SET deleted = true
        WHERE userIdx = #{userIdx}
    </update>

    <select id="countByEmail" parameterType="com.mbcTeam.user.UserVO" resultType="int">
        SELECT COUNT(*)
        FROM users
        WHERE id = #{id}
    </select>

    <select id="getByEmail" parameterType="com.mbcTeam.user.UserVO" resultType="com.mbcTeam.user.UserVO">
        SELECT
            userIdx        AS userIdx,
            id     AS id,
            password        AS password,
            userName      AS userName,
            userPhone     AS userPhone,
            userRole      AS userRole,
            isEasyLogin     AS easyLogin,
            isDeleted        AS deleted,
            regDate  AS regDate
        FROM users
        WHERE id = #{id}
    </select>




 <update id="UPDATE_USER" parameterType="com.mbcTeam.user.UserVO">
        UPDATE users
        SET
            id  = #{id},
            user_phone = #{userPhone}
        WHERE userIdx = #{userIdx}
    </update>


<select id="GET_USER_BY_ID" parameterType="String" resultType="com.mbcTeam.user.UserVO">
    SELECT  
        userIdx,
        id, 
        password, 
        user_Name      AS userName,
        user_Phone     AS userPhone,
        user_Role      AS userRole, 
        is_easy_login  AS easyLogin,
        is_deleted     AS deleted,
        reg_Date       AS regDate
    FROM users 
    WHERE id = #{id}  AND is_deleted = 0
</select>

</mapper>